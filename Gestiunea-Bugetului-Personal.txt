-- CREAREA TABELELOR
CREATE TABLE UTILIZATORI (
    ID_UTILIZATOR INT PRIMARY KEY NOT NULL,
    NUME VARCHAR(25), 
    PRENUME VARCHAR(25),
    EMAIL VARCHAR(50),
    PAROLA VARCHAR(25),
    NR_TELEFON VARCHAR(14),
    DATA_INREGISTRARII DATE
);
DROP TABLE UTILIZATORI;

CREATE TABLE CONTURI(
    ID_UTILIZATOR INT NOT NULL,
    ID_CONT INT PRIMARY KEY NOT NULL,
    FOREIGN KEY (ID_UTILIZATOR) REFERENCES UTILIZATORI(ID_UTILIZATOR),
    NUME_CONT VARCHAR(50),
    TIP_CONT VARCHAR(50),
    BALANTA_INCEPUT DECIMAL(10,2)
);

DROP TABLE CONTURI;

CREATE TABLE ECONOMII(
    ID_UTILIZATOR INT NOT NULL,
    ID_ECONOMIE INT PRIMARY KEY NOT NULL,
    FOREIGN KEY (ID_UTILIZATOR) REFERENCES UTILIZATORI(ID_UTILIZATOR),
    SUMA_ECONOMIE DECIMAL(10,2),
    DATA_ECONOMIE DATE
);

DROP TABLE ECONOMII;

CREATE TABLE IMPRUMUTURI(
    ID_IMPRUMUT INT PRIMARY KEY NOT NULL,
    ID_DATORNIC INT NOT NULL,
    ID_CREDITOR INT NOT NULL,
    SUMA_IMPRUMUT DECIMAL(10,2),
    DATA_INCEPUT DATE,
    DATA_SFARSIT DATE,
    DOBANDA DECIMAL(5,2),
    STARE_IMPRUMUT VARCHAR(25) CHECK (STARE_IMPRUMUT IN ('Achitat', 'Neachitat')),
    FOREIGN KEY (ID_DATORNIC) REFERENCES UTILIZATORI(ID_UTILIZATOR),
    FOREIGN KEY (ID_CREDITOR) REFERENCES UTILIZATORI(ID_UTILIZATOR)
);

DROP TABLE IMPRUMUTURI;

CREATE TABLE CATEGORII(
    ID_CATEGORIE INT PRIMARY KEY NOT NULL,
    NUME_CATEGORIE VARCHAR(25) NOT NULL
);

DROP TABLE CATEGORII;

CREATE TABLE TRANZACTII(
    ID_TRANZACTIE INT PRIMARY KEY NOT NULL,
    ID_CONT INT NOT NULL,
    SUMA DECIMAL(10, 2),
    DATA_TRANZACTIE DATE,
    TIP VARCHAR(15) CHECK (TIP IN ('Venit', 'Cheltuială')),
    ID_CATEGORIE INT NOT NULL,
    FOREIGN KEY (ID_CONT) REFERENCES CONTURI(ID_CONT),
    FOREIGN KEY (ID_CATEGORIE) REFERENCES CATEGORII(ID_CATEGORIE)
);

DROP TABLE TRANZACTII;


-- INSERAREA SI UMPLEREA TABELELOR

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (1,'BICA','MARIUS ADRIAN','mbica36599@gmail.com','PAROLABAZEDEDATE','0765975685',TO_DATE('10-05-2018', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (2,'POPESCU','ION','popescu98@yahoo.com','PAROLABAZEDEDATE','0748591479',TO_DATE('08-12-2010', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (3,'VASILE','ION','ionVasile22@email.com','PAROLABAZEDEDATE','0726381167',TO_DATE('11-05-2013', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (4,'BOROS','KEVIN','cevafain@gmail.com','PAROLABAZEDEDATE','0799176544',TO_DATE('01-01-2003', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (5,'BUZATU','ALEXANDRU','buzatuA@gmail.com','PAROLABAZEDEDATE','0744587139',TO_DATE('09-07-2000', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (6,'BĂNUȚĂ','ALEXANDRU','AleXadru@gmail.com','PAROLABAZEDEDATE','0727361927',TO_DATE('22-02-2021', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (7,'BRAȘOVEANU','EDUARD','EduardB@gmail.com','PAROLABAZEDEDATE','0777162634',TO_DATE('21-03-2022', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (8,'ANA','MARIA','@AnaMaria2@gmail.com','PAROLABAZEDEDATE','0713841533',TO_DATE('13-09-2020', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (9,'PĂUN','IONESCU','Paunion123@outlook.com','PAROLABAZEDEDATE','0783663522',TO_DATE('30-09-2007', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (10,'VLADIMIR','CONSTANTIN','VladimirC11@gmail.com','PAROLABAZEDEDATE','0723116734',TO_DATE('10-05-2012', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (11,'BOGDAN','OCTAVIAN','bogdanOctavian@gmail.com','PAROLABAZEDEDATE','0738574658',TO_DATE('07-09-2009', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (12,'POPESCU','MARCEL','pOpescuMarCel@yahoo.com','PAROLABAZEDEDATE','0777395867',TO_DATE('08-11-1997', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (13,'CAZACU','ION DUMITRU','ionVasile22@email.com','PAROLABAZEDEDATE','0789364899',TO_DATE('11-08-2010', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (14,'DORIAN','CONSTANTIN','dorianC@gmail.com','PAROLABAZEDEDATE','0710291038',TO_DATE('21-03-2013', 'DD-MM-YYYY'));

INSERT INTO UTILIZATORI (ID_UTILIZATOR,NUME,PRENUME,EMAIL,PAROLA,NR_TELEFON,DATA_INREGISTRARII) 
VALUES (15,'TEODOR','DAN MIHAI','TDMihai@gmail.com','PAROLABAZEDEDATE','0729502876',TO_DATE('19-07-2002', 'DD-MM-YYYY'));

SELECT* FROM UTILIZATORI ORDER BY 1;

-- conturi

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (10,1,'BCR','Curent',5000);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (11,2,'BRD','Economii',3800);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (12,3,'BRD','Curent',4500);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (13,4,'BCR','Curent',6000);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (14,5,'Raiffeisen','Depozit',10000);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (15,6,'Raiffeisen','Economii',8500);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (16,7,'ING','Curent',3900);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (17,8,'BCR','Economii',3300);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (18,9,'BCR','Curent',4500);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (19,10,'BRD','Economii',3500);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (20,11,'Raiffeisen','Curent',3200);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (21,12,'BCR','Economii',6500);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (22,13,'BRD','Depozit',8000);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (23,14,'ING','Depozit',10000);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (24,15,'BCR','Economii',12000);

INSERT INTO CONTURI (ID_CONT,ID_UTILIZATOR,NUME_CONT,TIP_CONT,BALANTA_INCEPUT) 
VALUES (25,1,'ING','Curent',7500);

 SELECT* FROM CONTURI ORDER BY ID_CONT;


-- imprumuturi

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (50,1,10,500,TO_DATE('19-07-2023', 'DD-MM-YYYY'),TO_DATE('19-07-2024', 'DD-MM-YYYY'),'Achitat',5);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (51,10,12,500,TO_DATE('01-03-2023', 'DD-MM-YYYY'),TO_DATE('01-03-2024', 'DD-MM-YYYY'),'Neachitat',5);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (52,2,11,1000,TO_DATE('11-02-2023', 'DD-MM-YYYY'),TO_DATE('11-08-2023', 'DD-MM-YYYY'),'Achitat',10);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (53,3,10,1000,TO_DATE('28-02-2023', 'DD-MM-YYYY'),TO_DATE('28-08-2023', 'DD-MM-YYYY'),'Achitat',20);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (54,4,1,2000,TO_DATE('21-11-2023', 'DD-MM-YYYY'),TO_DATE('21-11-2024', 'DD-MM-YYYY'),'Neachitat',15);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (55,5,2,1500,TO_DATE('22-12-2023', 'DD-MM-YYYY'),TO_DATE('22-03-2024', 'DD-MM-YYYY'),'Neachitat',10);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (56,5,5,1000,TO_DATE('23-10-2023', 'DD-MM-YYYY'),TO_DATE('23-06-2024', 'DD-MM-YYYY'),'Achitat',10);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (57,7,8,1800,TO_DATE('13-07-2023', 'DD-MM-YYYY'),TO_DATE('13-10-2024', 'DD-MM-YYYY'),'Neachitat',25);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (58,7,9,1600,TO_DATE('17-05-2023', 'DD-MM-YYYY'),TO_DATE('17-02-2024', 'DD-MM-YYYY'),'Neachitat',15);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (59,10,1,1000,TO_DATE('09-03-2023', 'DD-MM-YYYY'),TO_DATE('09-07-2023', 'DD-MM-YYYY'),'Achitat',10);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (60,10,13,800,TO_DATE('06-06-2023', 'DD-MM-YYYY'),TO_DATE('06-06-2025', 'DD-MM-YYYY'),'Neachitat',20);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (61,1,9,600,TO_DATE('03-06-2023', 'DD-MM-YYYY'),TO_DATE('03-01-2025', 'DD-MM-YYYY'),'Neachitat',25);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (62,11,11,700,TO_DATE('13-04-2023', 'DD-MM-YYYY'),TO_DATE('13-04-2024', 'DD-MM-YYYY'),'Neachitat',20);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (63,12,6,3000,TO_DATE('12-11-2023', 'DD-MM-YYYY'),TO_DATE('12-05-2024', 'DD-MM-YYYY'),'Achitat',15);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (64,1,7,500,TO_DATE('30-03-2023', 'DD-MM-YYYY'),TO_DATE('30-09-2023', 'DD-MM-YYYY'),'Achitat',15);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (65,2,8,700,TO_DATE('21-02-2023', 'DD-MM-YYYY'),TO_DATE('21-02-2024', 'DD-MM-YYYY'),'Neachitat',15);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (66,5,9,600,TO_DATE('20-01-2023', 'DD-MM-YYYY'),TO_DATE('20-07-2023', 'DD-MM-YYYY'),'Achitat',10);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (67,4,3,600,TO_DATE('24-01-2023', 'DD-MM-YYYY'),TO_DATE('24-02-2024', 'DD-MM-YYYY'),'Achitat',10);

INSERT INTO IMPRUMUTURI (ID_IMPRUMUT,ID_DATORNIC,ID_CREDITOR,SUMA_IMPRUMUT,DATA_INCEPUT,DATA_SFARSIT,STARE_IMPRUMUT,DOBANDA) 
VALUES (68,3,6,1000,TO_DATE('30-09-2023', 'DD-MM-YYYY'),TO_DATE('30-01-2024', 'DD-MM-YYYY'),'Achitat',10);

SELECT* FROM IMPRUMUTURI ORDER BY ID_DATORNIC;
SELECT* FROM IMPRUMUTURI ORDER BY ID_IMPRUMUT;

-- tranzactii

-- 1
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (100,10,3,500,TO_DATE('15-06-2021', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (101,25,1,4000,TO_DATE('10-03-2022', 'DD-MM-YYYY'),'Venit');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (102,10,4,1000,TO_DATE('19-05-2023', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (103,10,5,2000,TO_DATE('12-08-2023', 'DD-MM-YYYY'),'Cheltuială');


--2 
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (104,11,5,2000,TO_DATE('07-11-2020', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (105,11,2,2500,TO_DATE('13-07-2021', 'DD-MM-YYYY'),'Venit');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (106,11,4,500,TO_DATE('28-01-2022', 'DD-MM-YYYY'),'Cheltuială');

--3
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (107,12,4,4000,TO_DATE('30-02-2022', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (108,12,1,6000,TO_DATE('07-07-2022', 'DD-MM-YYYY'),'Venit');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (109,12,4,900,TO_DATE('12-09-2023', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (110,12,1,1000,TO_DATE('17-11-2023', 'DD-MM-YYYY'),'Venit');

--4
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (111,13,1,1500,TO_DATE('23-12-2021', 'DD-MM-YYYY'),'Venit');

--5
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (112,14,4,500,TO_DATE('29-06-2022', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (113,14,1,1800,TO_DATE('26-05-2023', 'DD-MM-YYYY'),'Venit');

--6
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (114,15,3,2000,TO_DATE('16-03-2021', 'DD-MM-YYYY'),'Cheltuială');

--7
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (115,16,1,5000,TO_DATE('09-01-2021', 'DD-MM-YYYY'),'Venit');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (116,16,3,2000,TO_DATE('03-02-2021', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (117,16,1,2000,TO_DATE('11-10-2023', 'DD-MM-YYYY'),'Venit');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (118,16,2,1000,TO_DATE('13-12-2023', 'DD-MM-YYYY'),'Cheltuială');

--8
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (119,17,1,3500,TO_DATE('17-01-2022', 'DD-MM-YYYY'),'Venit');

--9
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (120,18,4,1800,TO_DATE('22-07-2022', 'DD-MM-YYYY'),'Cheltuială');

--10
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (121,19,4,3500,TO_DATE('21-02-2022', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (122,19,1,2000,TO_DATE('04-01-2023', 'DD-MM-YYYY'),'Venit');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (123,19,1,2000,TO_DATE('08-11-2023', 'DD-MM-YYYY'),'Venit');

--11
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (124,20,4,2500,TO_DATE('12-09-2021', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (125,20,1,2500,TO_DATE('10-08-2022', 'DD-MM-YYYY'),'Venit');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (126,20,4,1000,TO_DATE('02-05-2023', 'DD-MM-YYYY'),'Cheltuială');

--12
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (127,21,4,1000,TO_DATE('24-05-2022', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (128,21,5,2000,TO_DATE('15-04-2023', 'DD-MM-YYYY'),'Cheltuială');

--13
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (129,22,1,2000,TO_DATE('06-10-2021', 'DD-MM-YYYY'),'Venit');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (130,22,1,1500,TO_DATE('19-06-2022', 'DD-MM-YYYY'),'Venit');

--14
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (131,23,4,1500,TO_DATE('26-09-2023', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (132,23,1,1800,TO_DATE('17-11-2023', 'DD-MM-YYYY'),'Venit');

--15
INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (133,24,2,2000,TO_DATE('10-01-2022', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (134,24,1,1500,TO_DATE('18-02-2022', 'DD-MM-YYYY'),'Venit');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (135,24,3,2500,TO_DATE('22-09-2023', 'DD-MM-YYYY'),'Cheltuială');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (136,24,1,2000,TO_DATE('05-11-2023', 'DD-MM-YYYY'),'Venit');

INSERT INTO TRANZACTII (ID_TRANZACTIE,ID_CONT,ID_CATEGORIE,SUMA,DATA_TRANZACTIE,TIP) 
VALUES (137,24,2,1800,TO_DATE('08-12-2023', 'DD-MM-YYYY'),'Cheltuială');

SELECT* FROM TRANZACTII ORDER BY ID_CONT;
SELECT* FROM TRANZACTII ORDER BY ID_TRANZACTIE;

-- categorii

INSERT INTO CATEGORII(ID_CATEGORIE,NUME_CATEGORIE)
VALUES (1,'Depunere');

INSERT INTO CATEGORII(ID_CATEGORIE,NUME_CATEGORIE)
VALUES (2,'Retragere');

INSERT INTO CATEGORII(ID_CATEGORIE,NUME_CATEGORIE)
VALUES (3,'Investiții');

INSERT INTO CATEGORII(ID_CATEGORIE,NUME_CATEGORIE)
VALUES (4,'Plată');

INSERT INTO CATEGORII(ID_CATEGORIE,NUME_CATEGORIE)
VALUES (5,'Transfer');

SELECT* FROM CATEGORII ORDER BY ID_CATEGORIE;

-- economii
--1
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (20,1,2000,TO_DATE('11-06-2022', 'DD-MM-YYYY'));

INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (21,1,4000,TO_DATE('31-10-2023', 'DD-MM-YYYY'));

INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (22,1,4000,TO_DATE('27-11-2023', 'DD-MM-YYYY'));

--2
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (23,2,4500,TO_DATE('30-01-2023', 'DD-MM-YYYY'));

INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (24,2,3500,TO_DATE('30-06-2023', 'DD-MM-YYYY'));

--3
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (25,3,4000,TO_DATE('21-02-2022', 'DD-MM-YYYY'));

--4
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (26,4,3000,TO_DATE('27-04-2023', 'DD-MM-YYYY'));

--5
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (27,5,2000,TO_DATE('15-05-2023', 'DD-MM-YYYY'));

--6
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (28,6,2500,TO_DATE('10-07-2023', 'DD-MM-YYYY'));

INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (29,6,2000,TO_DATE('10-08-2023', 'DD-MM-YYYY'));

INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (30,6,2500,TO_DATE('10-09-2023', 'DD-MM-YYYY'));

--7
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (31,7,2000,TO_DATE('05-06-2023', 'DD-MM-YYYY'));

INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (32,7,3000,TO_DATE('13-09-2023', 'DD-MM-YYYY'));

--8
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (33,8,4000,TO_DATE('02-08-2023', 'DD-MM-YYYY'));

--9
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (34,9,3800,TO_DATE('19-10-2023', 'DD-MM-YYYY'));

--10
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (35,10,3500,TO_DATE('28-11-2022', 'DD-MM-YYYY'));

INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (36,10,3500,TO_DATE('28-11-2022', 'DD-MM-YYYY'));

--11
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (37,11,4000,TO_DATE('07-09-2023', 'DD-MM-YYYY'));

INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (38,11,2500,TO_DATE('12-12-2023', 'DD-MM-YYYY'));

--12
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (39,12,8000,TO_DATE('22-01-2022', 'DD-MM-YYYY'));

INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (40,12,6000,TO_DATE('12-11-2022', 'DD-MM-YYYY'));

--13
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (41,13,6000,TO_DATE('25-02-2022', 'DD-MM-YYYY'));

--14
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (42,14,4000,TO_DATE('14-04-2021', 'DD-MM-YYYY'));

--15
INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (43,15,4000,TO_DATE('19-03-2022', 'DD-MM-YYYY'));

INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (44,15,3000,TO_DATE('20-11-2022', 'DD-MM-YYYY'));

INSERT INTO ECONOMII(ID_ECONOMIE,ID_UTILIZATOR,SUMA_ECONOMIE,DATA_ECONOMIE)
VALUES (45,15,5000,TO_DATE('21-03-2023', 'DD-MM-YYYY'));

SELECT* FROM ECONOMII ORDER BY ID_ECONOMIE;
SELECT* FROM ECONOMII ORDER BY SUMA_ECONOMIE;


-- ALTER, DROP, CONSTRAINT
ALTER TABLE IMPRUMUTURI
ADD DOBANDA DECIMAL(5,2);

ALTER TABLE UTILIZATORI
ADD CONSTRAINT UNIQUE_EMAIL
UNIQUE (EMAIL);

ALTER TABLE UTILIZATORI
ADD CONSTRAINT CHECK_TELEFON
CHECK (LENGTH(NR_TELEFON) = 10);

ALTER TABLE UTILIZATORI
DROP CONSTRAINT CHECK_TELEFON;

ALTER TABLE UTILIZATORI
MODIFY NR_TELEFON VARCHAR(20);

ALTER TABLE CONTURI
MODIFY BALANTA_INCEPUT DEFAULT 0;

ALTER TABLE UTILIZATORI MODIFY NUME NOT NULL;

ALTER TABLE UTILIZATORI MODIFY PRENUME NOT NULL,

ALTER TABLE UTILIZATORI MODIFY PAROLA NOT NULL,

ALTER TABLE UTILIZATORI MODIFY NR_TELEFON NOT NULL;


-- SCHIMBA PAROLA UNUI UTILIZATOR
UPDATE UTILIZATORI
SET PAROLA = 'parolanoua'
WHERE ID_UTILIZATOR = 3;

-- ACTUALIZEAZA SUMA UNEI ECONOMII 
UPDATE ECONOMII
SET SUMA_ECONOMIE = 10000
WHERE ID_ECONOMIE = 7;

-- MODIFICA DATA UNEI TRANZACTII 
UPDATE TRANZACTII
SET DATA_TRANZACTIE = TO_DATE('01-01-2000', 'DD-MM-YYYY')
WHERE ID_TRANZACTIE = 5;

-- STERGE UN UTILIZATOR DIN BAZA DE DATE
DELETE FROM UTILIZATORI
WHERE ID_UTILIZATOR=2;

-- STERGE UN CONT BANCAR
DELETE FROM CONTURI
WHERE ID_CONT=10;

-- RESTRCTIE CHECK(NE ASIGURAM CA BALANTA NU E NICIODATA NEGATIVA)
ALTER TABLE CONTURI
ADD CONSTRAINT CK_BALANTA
CHECK (BALANTA_INCEPUT>=0);


-- CERINTE PROIECT

-- 3.1	Verificați ca fiecare email să fie unic (diferit)
ALTER TABLE UTILIZATORI
ADD CONSTRAINT UNIQUE_EMAIL
UNIQUE (EMAIL);

-- 3.2	Adăugați o restricție fixă la nr de telefon(exact 10 cifre)
ALTER TABLE UTILIZATORI
ADD CONSTRAINT CHECK_TELEFON
CHECK (LENGTH(NR_TELEFON) = 10);

-- 3.3	Înlăturați restricția precedentă
ALTER TABLE UTILIZATORI
DROP CONSTRAINT CHECK_TELEFON;

-- 3.4	Eliminați coloana parola din tabela utilizatori
ALTER TABLE UTILIZATORI
DROP COLUMN PAROLA;

-- 3.5	Modificați nr maxim de cifre al nr de telefon
ALTER TABLE UTILIZATORI
MODIFY NR_TELEFON VARCHAR(20);

-- 3.6	Adăugați în tabela împrumuturi o variabila bool care verifica daca împrumutul a fost achitat sau nu
ALTER TABLE ÎMPRUMUTURI
ADD ACHITAT BOOL;

UPDATE ÎMPRUMUTURI
SET ACHITAT = CASE WHEN STARE_IMPRUMUT=’Achitat’ THEN 1
ELSE 0
END;

--3.7	Eliminați variabila precedentă
ALTER TABLE ÎMPRUMUTURI
DROP COLUMN BOOL;

--3.8	Setați inițializarea balanței de început a contului la 0
ALTER TABLE CONTURI
MODIFY BALANTA_INCEPUT DEFAULT 0;

--3.9	Adaugați o constrângere prin care numele și prenumele să fie obligatorii
ALTER TABLE UTILIZATORI MODIFY NUME NOT NULL;
ALTER TABLE UTILIZATORI MODIFY PRENUME NOT NULL;

--3.10	Adăugați o restricție dobânzii încât să poată lua valori numai între 0 și 30 
ALTER TABLE IMPRUMUTURI
ADD CONSTRAINT CHECK_DOBANDA
CHECK (DOBANDA>=0 AND DOBANDA<=30)

--3.11	Ștergeți conturile bancare de la ING cu peste 10000lei:
          DELETE FROM CONTURI 
          WHERE NUME_CONT='ING'
          AND  BALANTA_INCEPUT>10000;


--	Operații de actualizare a datelor:
--3.12	Schimbă parola unui utilizator:
        UPDATE UTILIZATORI
        SET PAROLA = 'parolanoua'
        WHERE ID_UTILIZATOR = 3;

--3.13	Actualizeaza suma economiei cu id-ul 22
         UPDATE ECONOMII
         SET SUMA_ECONOMIE = 5000
         WHERE ID_ECONOMIE = 22;

--3.14	Actualizează suma economiei utilizatorului 10
           UPDATE ECONOMII
           SET SUMA_ECONOMIE = 1000
           WHERE ID_UTILIZATOR = 10;

--3.15	Modifica data tranzacției cu id-ul 105, adăugând o zi.
         UPDATE TRANZACTII
         SET DATA_TRANZACTIE = DATA_TRANZACTIE+1
         WHERE ID_TRANZACTIE = 105;

--3.16	Șterge utilizatorul “Dorian Constantin” din baza de date
         DELETE FROM UTILIZATORI
         WHERE UPPER(NUME)='DORIAN' AND UPPER(PRENUME)='CONSTANTIN'; 

--3.17	Sa se updateze toate împrumuturile ca fiind ‚Achitate’
      UPDATE IMPRUMUTURI
      SET STARE_IMPRUMUT = 'Achitat';

--3.18	Să se modifice cu 1% toate dobânzile neachiate de peste 10%
           UPDATE IMPRUMUTURI
           SET DOBANDA = DOBANDA - 1
           WHERE STARE_IMPRUMUT = 'Neachitat' AND DOBANDA >10;

--3.19	Să se reseteze la o parolă generică toate conturile care nu au accesat baza de date de peste 1 an
          UPDATE UTILIZATORI
          SET PAROLA = 'parolaGenerica'
          WHERE DATA_INREGISTRARII < ADD_MONTHS(SYSDATE, -12);

--3.20	Adăugați o suma fixă de început balanței tuturor conturilor 
            UPDATE CONTURI
            SET BALANTA_INCEPUT = BALANTA_INCEPUT + 100;

--3.21	Să se șteargă opțiunea de ‘Depunere’ pt toate tranzacțiile
            DELETE FROM CATEGORII
            WHERE NUME_CATEGORIE = 'Depunere';

	--Interogări variate:
--3.22	Afișați tranzacțiile mai noi de 10.10.2020
        SELECT *
        FROM TRANZACTII      
        WHERE DATA_TRANZACTIE > TO_DATE('2020-10-10', 'YYYY-MM-DD');

--3.23	Câte tranzacții de tip venit au fost în 2023
         SELECT COUNT(*) AS NUMAR_TRANZACTII_VENIT
         FROM TRANZACTII
        WHERE TIP = 'Venit' AND EXTRACT(YEAR FROM DATA_TRANZACTIE) = 2023;

       -- 3.23	Afișați utilizatorul cu nr de telefon care se termina în ‘685’
         SELECT NUME,PRENUME FROM UTILIZATORI 
         WHERE NR_TELEFON LIKE '%685';

--3.24	Afișați descrecător utilizatorii în funcție de suma totală de datorii pe care o au

SELECT 
    U.ID_UTILIZATOR, 
    U.NUME, 
    U.PRENUME, 
    SUM(I.SUMA_IMPRUMUT) AS TOTAL_DATORII
FROM 
    UTILIZATORI U
JOIN 
    IMPRUMUTURI I ON U.ID_UTILIZATOR = I.ID_DATORNIC
GROUP BY 
    U.ID_UTILIZATOR, U.NUME, U.PRENUME
ORDER BY 
    TOTAL_DATORII DESC;

--3.25	Să se afișeze securitatea conturilor (dacă utilizatorii au sau nu email și parolă)
       SELECT ID_UTILIZATOR, NVL(EMAIL, 'Fara Email') AS EMAIL,          DECODE(PAROLA, NULL, 'Fara Parola', 'Cu Parola') AS STATUS_PAROLA
FROM UTILIZATORI ORDER BY ID_UTILIZATOR;

--3.26	Să se afișeze id-ul utilizatorului care a acordat mai mult 2 împrumuturi (creditor)
        SELECT ID_CREDITOR, COUNT(*) AS NR_IMPRUMUTURI
        FROM IMPRUMUTURI
        GROUP BY ID_CREDITOR 
        HAVING COUNT(*) > 2;

--3.27	Să se afișeze toți utilizatorii care au datorii folosind interesect
          SELECT ID_UTILIZATOR FROM UTILIZATORI
          INTERSECT
          SELECT ID_DATORNIC FROM IMPRUMUTURI;

--3.28	Aceeași cerință, dar cu Join
            SELECT DISTINCT U.ID_UTILIZATOR
            FROM UTILIZATORI U
            JOIN IMPRUMUTURI I ON U.ID_UTILIZATOR = I.ID_DATORNIC;

--3.29	Să se calculeze soldul final al tranzacțiilor pt fiecare cont
         SELECT 
          ID_CONT, 
          SUM(CASE WHEN TIP = 'Venit' THEN SUMA ELSE -SUMA END) AS           SOLD_FINAL
FROM TRANZACTII
GROUP BY ID_CONT;

--3.30	Să se afișeze câte conturi sunt din fiecare tip
            SELECT TIP_CONT, COUNT(*) AS NR_CONTURI
            FROM CONTURI GROUP BY TIP_CONT;
--3.31	Să se afișeze câți utilizatori s-au conectat cu telefonul mobil și câți cu cel fix
        SELECT 
          CASE 
          WHEN NR_TELEFON LIKE '07%' THEN 'Mobil'  ELSE 'Fix'
            END AS TIP_TELEFON,
           COUNT(*) NUMAR_UTILIZATORI
           FROM UTILIZATORI
           GROUP BY 
           CASE 
           WHEN NR_TELEFON LIKE '07%' THEN 'Mobil' ELSE 'Fix' END;

--3.32	Să se afișeze câte tranzacții are fiecare cont al utilizatorilor
          SELECT U.NUME, U.PRENUME, 
          (SELECT COUNT(*) FROM TRANZACTII T WHERE T.ID_CONT = C.ID_CONT) AS NR_TRANZACTII
          FROM UTILIZATORI U
          JOIN CONTURI C ON U.ID_UTILIZATOR = C.ID_UTILIZATOR;

--3.33	Să se afișeze decrescător toate tranzacțiile de peste 2000lei
          SELECT ID_TRANZACTIE, ID_CONT, SUMA, DATA_TRANZACTIE
          FROM TRANZACTII
          WHERE SUMA > 2000
          ORDER BY SUMA DESC;

--3.34	Identificați tipurile de tranzacții care au fost efectuate de mai mult de 3 ori

SELECT T.ID_CATEGORIE, C.NUME_CATEGORIE, COUNT(*) NR_TRANZACTII
FROM TRANZACTII T
JOIN CATEGORII C ON T.ID_CATEGORIE = C.ID_CATEGORIE
GROUP BY T.ID_CATEGORIE, C.NUME_CATEGORIE
HAVING COUNT(*) >= 3;

--3.35	Afișați împrumuturile și cine e creditorul și debitorul

SELECT U1.NUME AS NUME_DATORNIC, U2.NUME AS NUME_CREDITOR, I.SUMA_IMPRUMUT, I.DOBANDA
FROM IMPRUMUTURI I
JOIN UTILIZATORI U1 ON I.ID_DATORNIC = U1.ID_UTILIZATOR
JOIN UTILIZATORI U2 ON I.ID_CREDITOR = U2.ID_UTILIZATOR;

--3.36	Să se afișeze cel mai mare împrumut pt fiecare utilizator
    SELECT 
    U.ID_UTILIZATOR, 
    U.NUME, 
    U.PRENUME, 
    MAX(I.SUMA_IMPRUMUT) AS MAX_IMPRUMUT
FROM 
    UTILIZATORI U
LEFT JOIN 
    IMPRUMUTURI I ON U.ID_UTILIZATOR = I.ID_DATORNIC
GROUP BY 
    U.ID_UTILIZATOR, U.NUME, U.PRENUME;



ALTER TABLE IMPRUMUTURI
ADD ACHITAT BOOL;

UPDATE IMPRUMUTURI
SET ACHITAT = CASE WHEN STARE_IMPRUMUT='Achitat' THEN 1
ELSE 0
END;
